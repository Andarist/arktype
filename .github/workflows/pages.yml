name: pages

on:
    push:
        branches: [main]

jobs:
    update-site:
        runs-on: ubuntu-latest
        timeout-minutes: 20
        steps:
            - name: Checkout re-po
              uses: actions/checkout@v3
              with:
                  fetch-depth: 0

            - name: Setup re-po
              uses: ./.github/actions/setup

            - name: Build redo.dev
              run: pnpm build-pages

            - name: Publish redo.dev
              uses: rayluo/github-pages-overwriter@v1.2
              with:
                  source-directory: ./redo.dev/dist
                  target-branch: gh-pages
